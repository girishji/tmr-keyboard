To turn on sensors:


The **MDT TMR2617** (specifically the TMR2617S-AAC) is an integrated sensor that combines the TMR bridge with a signal-conditioning ASIC (which includes the op-amp and DAC).

According to the datasheet, the most important specification for your pulsing strategy is the **Power-on Time (t_{PO})**.

###The Specs for TMR2617* **Power-on Time (t_{PO}):** **100$\mu$s (Maximum).** This is the time it takes for the internal circuitry to stabilize after power is applied.
* **Bandwidth:** **50kHz.** This is relatively slow for an op-amp, confirming that it is optimized for low power (<300\mu\text{A}) rather than speed.
* **Output Load:** It requires a load resistance (R_L) of at least **10k$\Omega$** to maintain accuracy.

###Is the 50$\mu$s "Waste" Real?You mentioned the sensor only needs 100$\mus, but the **TPS22916** takes 150\mus to ramp up. You aren't actually losing 50\mu$s of battery life; here is why:

1. **Parallel Timelines:** The 100$\mu$s "Power-on time" of the sensor starts the moment the voltage hits its minimum operating threshold (1.6V). Because the TPS22916 ramps up gradually, the sensor starts "waking up" while the switch is still in the middle of its ramp.
2. **The Settle Time:** Even if the sensor says "100$\mus," the output might still be "ringing" or settling as the internal DAC and Op-amp stabilize. For high-precision ADC readings, waiting until the power rail is **100% stable** (the end of the 150\mu$s ramp) + a small buffer is standard practice.
3. **Instant-On Risks:** If you used a switch that turned on in 1$\mu$s, you would create a **massive EMI (Electromagnetic Interference) spike** on your PCB. This spike can couple into the sensitive high-impedance lines of your TMR bridge, actually *increasing* the time you have to wait for the signal to be clean enough to read.

###The Optimized Pulse SequenceIf you want to be as aggressive as possible with power savings, use this sequence:

* **T=0$\mu$s:** Pull "Enable" pin HIGH on the TPS22916.
* **T=150$\mu$s:** The power rail is now fully stable at 3V.
* **T=200$\mu$s:** Take your ADC sample (this gives the internal op-amp 50-100$\mu$s of "quiet" time at full voltage).
* **T=210$\mu$s:** Pull "Enable" pin LOW.

###Summary of PartsSince you have 9 banks and want to power one at a time:

* **Switch:** Use **5x DMP2004DWK** (Dual P-Channel MOSFETs) if you want the cheapest/smallest solution.
* **Switch:** Use **9x TPS22916B** (Single Load Switches) if you want the absolute cleanest signal and lowest battery leakage.

**Wait time suggestion:** Start with a **200$\mu$s delay** in your code. If your readings are stable, you can try shortening it by 10$\mu$s increments until the data starts to jitter, then back off.

Would you like me to help you write the pseudo-code for the "Scan Loop" that rotates through these 9 banks?


---
---
Q:
if i use TPS22916, and it takes 150us (while tmr sensor only needs 100us to switch on), will it not waste power by keeping on another 50us

Actually, the math is in your favor here. Using a load switch like the **TPS22916B** (the "Fast" version) doesn't just waste power; it actually **saves** the sensor from a much larger power waste: **Inrush Current.**

Here is the breakdown of why that extra 50–150$\mu$s is a smart trade-off:

###1. The Power Math: "Waste" vs. BenefitYou are worried about the 50\mus overlap. Let's look at the actual energy lost for one bank of 8 sensors (2.4mA total):

* **Extra Time:** 50\mu\text{s} (0.00005 seconds)
* **Voltage:** 3\text{V}
* **Current:** 2.4\text{mA}
* **Energy Wasted:** 3\text{V} \times 0.0024\text{A} \times 0.00005\text{s} = \mathbf{0.36\mu J} (Microjoules)

To put that in perspective: a standard CR2032 coin cell has about **2,500,000,000$\mu$J** of energy. You would have to pulse that sensor **7 billion times** before that specific "overlap waste" drained the battery.

###2. Why the "Slow" Slew Rate Saves PowerIf you used a "near-instant" switch (like a raw MOSFET with a very strong gate driver), the voltage at the sensors would jump from 0V to 3V in nanoseconds. This causes a massive **Inrush Current spike** as all the bypass capacitors on the sensor bank charge up instantly.

* **Instant Switch:** Can cause a spike of **100mA+** for a few microseconds.
* **Controlled Switch (TPS22916):** Limits that spike to just a few mA.

This prevents the **nPM1100** from having to "kick" into its high-power PWM mode to handle the spike, which actually saves more system power in the long run.

###3. Choose the "B" Version (Fast)The TPS22916 comes in different versions. You should specifically get the **TPS22916B** (the "Fast" timing version).

* **TPS22916C (Slow):** Takes ~3000$\mu$s at 1.8V (too slow for you).
* **TPS22916B (Fast):** Takes **~250$\mu$s** to reach full voltage at 1.8V-3V.

###How to Program the PulseTo be as efficient as possible, you should time your MCU code like this:

1. **Set Pin High:** (Switch starts ramping up).
2. **Wait 200$\mu$s:** (The "B" version is now at ~90% voltage).
3. **Wait 50$\mu$s:** (TMR and Op-amp settle—Op-amps often need more time than the sensor itself).
4. **Take ADC Sample:** (Duration: ~10$\mu$s).
5. **Set Pin Low:** (Switch turns off immediately).

**Total "ON" time: ~260$\mu$s.** Even though the switch takes longer to "arrive" at 3V, it turns **OFF** almost instantly. The "extra" time is mostly spent during the ramp-up, where the sensors are actually consuming *less* power than normal because the voltage hasn't hit 3V yet.

Would you like me to check the settling time of your specific Op-amp to see if we can trim that 200$\mu$s wait even further?

more:

Since you are only powering one bank at a time and using the **nPM1100** at 3V, your maximum current draw is only **2.4mA** (8 \text{ sensors} \times 300\mu\text{A}). This is extremely low, meaning you can prioritize **package size** and **leakage current** over power handling.

For 9 banks, you need 9 switches. The most efficient way to do this without a massive PCB footprint is to use **Dual P-Channel MOSFETs** or **Quad Load Switches**.

###1. The "Standard" Choice: DMP2004DWK (Dual P-Channel)This is a very common dual-MOSFET in a tiny **SOT-363** package. You would need 5 of these chips to cover 9 banks (leaving one spare channel).

* **Package:** SOT-363 (about 2 \text{mm} \times 2 \text{mm}).
* **Logic Level:** The "Gate Threshold" (V_{gs(th)}) is around **1.0V**, meaning it will turn on fully and reliably with your 3V nPM1100 supply and 3V MCU logic.
* **Why it's good:** It’s cheap, widely available, and perfect for low-current (mA-range) switching.

###2. The "Cleanest" Choice: TPS22916 (Single) or Dual EquivalentsIf you want to ensure your TMR sensor readings are ultra-stable, I highly recommend an **Integrated Load Switch** like the **TPS22916**.

* **Ultra-Low Leakage:** When a bank is "Off," it only leaks **10nA**. This is critical for battery life.
* **Quick Output Discharge (QOD):** When you switch a bank off, the chip actively pulls the sensor line to ground. This prevents the TMR sensors from "floating" and ensures the next bank's reading starts from a clean zero.
* **Controlled Slew Rate:** It ramps the power up smoothly over \sim 150\mu\text{s}, which prevents a "voltage dip" on the nPM1100 that could reset your MCU or glitch your ADC.

---

###Recommended Setup for 9 BanksSince you have 9 banks, the wiring becomes a "star" pattern from your nPM1100.

| Component | Recommendation |
| --- | --- |
| **Switch** | **DMP2004DWK** (Dual MOSFET) x 5 chips |
| **Pull-up Resistors** | 100\text{k}\Omega resistors on each Gate pin (to keep them OFF by default). |
| **Bypass Caps** | 0.1\mu\text{F} Ceramic Capacitor on the output of each MOSFET. |
| **Current Limit** | Not needed (TMR sensors are inherently resistive and current-limited). |

###Pro-Tip: Managing the 9 GPIO PinsIf your MCU is short on pins to control 9 individual MOSFETs, you can use a **3-to-8 line decoder** (like the **74LVC138**) or a **Shift Register** (like the **74HC595**).

* **Decoder:** Uses 3 pins to select 1-of-8 banks. (You'd need one extra pin for the 9th bank).
* **Shift Register:** Uses 3 pins to control an infinite number of banks.

**Would you like me to draw a simple schematic showing how to connect one of these dual MOSFETs to two sensor banks and your MCU?**

---
---

grok:
For your setup with 9 banks of 8 MDT TMR2617 sensors each (total current per bank: 8 × 300 μA = 2.4 mA at 3 V from the nPM1100 PMIC), where only one bank is powered at a time for 100 μs per cycle repeating every 10 ms, a suitable high-side switch should prioritize low on-resistance (R_ON), low quiescent current, compatibility with 3 V supply and logic control, small package size, and preferably built-in slew rate control to manage any potential inrush from the decoupling caps.

### Recommended Load Switch
I recommend the **TPS22932B** from Texas Instruments as a primary option. It's a single-channel, high-side P-channel MOSFET load switch optimized for low-voltage, low-power applications like yours. Key specs relevant to your needs:
- **Input Voltage Range**: 1.1 V to 3.6 V (fully compatible with your 3 V supply).
- **Maximum Continuous Current**: 500 mA (well above your 2.4 mA load).
- **On-Resistance (R_ON)**: Typically 85 mΩ at 3 V (minimal voltage drop: ~0.2 mV across the switch at 2.4 mA).
- **Slew Rate / Rise Time**: Internally controlled fixed rise time (around 165 μs typical), which limits inrush current during turn-on.
- **Quiescent Current**: <1 μA (negligible impact on your low-power system).
- **Control**: Active-high enable pin compatible with 1.2 V to 3.3 V logic (easy to drive from a microcontroller GPIO).
- **Other Features**: Quick output discharge (pulls output to ground when off to prevent floating voltages), and it's designed to minimize inrush currents from downstream capacitors.
- **Package**: Ultra-small 6-pin DSBGA (0.8 mm × 1.2 mm), ideal for compact designs.
- **Availability/Pricing**: Widely available from distributors like Mouser or Digi-Key; check current pricing there (typically under $1 in small quantities).

You'll need one TPS22932B per bank (9 total), with the input connected to the nPM1100's 3 V output, the output to the bank's power rail, and the enable pin to a GPIO for pulsing. The fixed slew rate ensures smooth turn-on without external components.

#### Alternatives
If the TPS22932B doesn't fit (e.g., if you need adjustable rise time or different packaging):
- **AP22913 from Diodes Incorporated**: Similar specs (1.5 V to 5.5 V input, 2 A max current, 50 mΩ R_ON at 3 V, fixed slew rate for inrush control, <1 μA quiescent). Comes in a tiny W-DFN1010-4 package.
- **SiP32458 from Vishay**: 1.5 V to 5.5 V input, 3 A max, 20 mΩ R_ON, integrated slew rate control, <1 μA quiescent. Available in WCSP-6.
- **SGM25117A from SG Micro**: 0.75 V to 5.5 V input, adjustable slew rate via external capacitor, ultra-low 6 mΩ R_ON, <1 μA quiescent. Good if you want to fine-tune the rise time.

These are all off-the-shelf parts from major manufacturers, with datasheets available on their websites for pinouts and application circuits.

### Regarding Load Surge from the 0.1 μF Decoupling Capacitors
Each bank has 8 × 0.1 μF = 0.8 μF total capacitance. When powering on a bank, this capacitance must charge from 0 V to 3 V, creating a brief inrush current.

- **Potential Issue?** Unlikely to cause significant problems in your system. The nPM1100's buck regulator supports up to 150 mA continuous output and handles load transients (e.g., 0 mA to 100 mA) with settling in ~20 μs. The charge required here is Q = C × V = 0.8 μF × 3 V = 2.4 μC. Without slew control, if the switch turns on very quickly (e.g., <1 μs), the peak inrush could theoretically spike to hundreds of mA for nanoseconds, but the nPM1100's recommended 10 μF output capacitor would absorb most of this, limiting voltage droop to ~0.24 V (negligible for your 100 μs pulse). Your 10 ms cycle and low duty cycle (0.9% per bank) keep average current minimal (~21 nA per bank).

- **Mitigation**: The decoupling caps are standard (and recommended for sensor stability to filter noise), so no need to remove them. Using a slew-rate-controlled switch like the TPS22932B limits dV/dt to ~0.018 V/μs, capping peak inrush at ~14 mA—well within the nPM1100's limits and preventing any EMI or supply ripple issues. If you use a basic P-MOSFET without slew control (e.g., BSS84P), add a small series resistor (10–100 Ω) or RC network to soften the turn-on, but a dedicated load switch is simpler and more efficient.

If your design has specific constraints (e.g., package size, cost, or exact rise time needs), provide more details for refined suggestions.


Q: what is 'slew control'?

**Slew control** (or **slew rate control**) in the context of power electronics—particularly high-side load switches and MOSFET drivers—refers to the intentional limiting of how quickly the output voltage rises (or falls) when the switch is turned on (or off). This is measured as **slew rate** in volts per microsecond (V/μs).

### Why is it important?
When you suddenly apply power to a load with **decoupling capacitors** (like your 0.1 μF per TMR sensor), the capacitors initially act like a short circuit while charging. This causes a large **inrush current spike** that can:
- Droop the supply voltage temporarily.
- Trigger overcurrent protection.
- Cause electromagnetic interference (EMI).
- Stress components or connectors.

Slew rate control provides a "soft start" by slowly ramping the output voltage, which limits the peak inrush current (I = C × dV/dt, where lower dV/dt means lower I).

In your TMR sensor application, slew control ensures the 0.8 μF total capacitance per bank charges gently, keeping inrush well below the nPM1100's capabilities and avoiding any supply glitches during your 100 μs pulses.
